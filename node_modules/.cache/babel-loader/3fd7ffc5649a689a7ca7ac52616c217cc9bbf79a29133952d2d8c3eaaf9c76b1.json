{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import CalendarComponent from'../components/CalendarComponent';import supabase from'../supabaseClient';// Import Supabase client\nimport'./Styling/adminDashboard.css';import AvailableTimesForm from'../components/AvailableTimesForm';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const[selectedDate,setSelectedDate]=useState(null);const[availableTimes,setAvailableTimes]=useState([]);const[bookings,setBookings]=useState([]);const[showTimesForm,setShowTimesForm]=useState(false);const fetchTimes=useCallback(async()=>{if(selectedDate){try{const{data,error}=await supabase.from('available-times').select('*').eq('date',selectedDate.toDateString());if(error)throw error;setAvailableTimes(data||[]);}catch(error){console.error('Failed to fetch times:',error);}}},[selectedDate]);useEffect(()=>{fetchTimes();},[fetchTimes]);const fetchBookings=useCallback(async()=>{try{const{data,error}=await supabase.from('bookings').select('*');if(error)throw error;setBookings(data||[]);}catch(error){console.error('Error fetching bookings:',error);}},[]);useEffect(()=>{fetchBookings();},[fetchBookings]);const handleSaveTimes=async times=>{if(selectedDate){try{// Assuming `times` is an array of objects with relevant fields\nfor(const time of times){const{error}=await supabase.from('available-times').upsert({date:selectedDate.toDateString(),...time});if(error)throw error;}setAvailableTimes(prevTimes=>[...prevTimes,...times]);}catch(error){console.error('Failed to save times:',error);}}};const handleDeleteTimes=async timesToDelete=>{if(selectedDate){try{const{error}=await supabase.from('available-times').delete().in('time',timesToDelete).eq('date',selectedDate.toDateString());if(error)throw error;setAvailableTimes(prevTimes=>prevTimes.filter(time=>!timesToDelete.includes(time)));}catch(error){console.error('Failed to delete times:',error);}}};const handleDeleteBooking=async bookingId=>{if(!bookingId){console.error('No booking ID provided');return;}try{const{error}=await supabase.from('bookings').delete().eq('id',bookingId);if(error)throw error;setBookings(prevBookings=>prevBookings.filter(booking=>booking.id!==bookingId));alert('Booking deleted successfully');}catch(error){console.error('Error deleting booking:',error);alert('Error deleting booking');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"heading\",children:\"Admin Dashboard\"}),/*#__PURE__*/_jsx(CalendarComponent,{setSelectedDate:setSelectedDate}),selectedDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"times-section\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"subHeading-dropdown-toggle\",onClick:()=>setShowTimesForm(!showTimesForm),children:/*#__PURE__*/_jsxs(\"h2\",{className:\"subHeading\",children:[\"Manage Times for \",selectedDate.toDateString()]})}),showTimesForm&&/*#__PURE__*/_jsx(AvailableTimesForm,{onSaveTimes:handleSaveTimes,onDeleteTimes:handleDeleteTimes,availableTimes:availableTimes})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"subHeading\",children:\"All Bookings\"}),/*#__PURE__*/_jsx(BookingsTable,{bookings:bookings,onDeleteBooking:handleDeleteBooking})]})]});};const BookingsTable=_ref=>{let{bookings,onDeleteBooking}=_ref;return/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Service\"}),/*#__PURE__*/_jsx(\"th\",{children:\"User Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"User Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"User Phone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bookings.map(booking=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:booking.date}),/*#__PURE__*/_jsx(\"td\",{children:booking.time}),/*#__PURE__*/_jsx(\"td\",{children:booking.service}),/*#__PURE__*/_jsx(\"td\",{children:booking.userName}),/*#__PURE__*/_jsx(\"td\",{children:booking.userEmail}),/*#__PURE__*/_jsx(\"td\",{children:booking.userPhone}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"delete-button\",onClick:()=>onDeleteBooking(booking.id),children:\"Cancel Booking\"})})]},booking.id))})]})});};export default AdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","useCallback","CalendarComponent","supabase","AvailableTimesForm","jsx","_jsx","jsxs","_jsxs","AdminDashboard","selectedDate","setSelectedDate","availableTimes","setAvailableTimes","bookings","setBookings","showTimesForm","setShowTimesForm","fetchTimes","data","error","from","select","eq","toDateString","console","fetchBookings","handleSaveTimes","times","time","upsert","date","prevTimes","handleDeleteTimes","timesToDelete","delete","in","filter","includes","handleDeleteBooking","bookingId","prevBookings","booking","id","alert","className","children","onClick","onSaveTimes","onDeleteTimes","BookingsTable","onDeleteBooking","_ref","map","service","userName","userEmail","userPhone"],"sources":["C:/Users/jarno/Desktop/Spa-Website/babyspa/src/pages/AdminDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport CalendarComponent from '../components/CalendarComponent';\r\nimport supabase from '../supabaseClient'; // Import Supabase client\r\nimport './Styling/adminDashboard.css';\r\nimport AvailableTimesForm from '../components/AvailableTimesForm';\r\n\r\nconst AdminDashboard = () => {\r\n    const [selectedDate, setSelectedDate] = useState(null);\r\n    const [availableTimes, setAvailableTimes] = useState([]);\r\n    const [bookings, setBookings] = useState([]);\r\n    const [showTimesForm, setShowTimesForm] = useState(false);\r\n\r\n    const fetchTimes = useCallback(async () => {\r\n        if (selectedDate) {\r\n            try {\r\n                const { data, error } = await supabase\r\n                    .from('available-times')\r\n                    .select('*')\r\n                    .eq('date', selectedDate.toDateString());\r\n\r\n                if (error) throw error;\r\n\r\n                setAvailableTimes(data || []);\r\n            } catch (error) {\r\n                console.error('Failed to fetch times:', error);\r\n            }\r\n        }\r\n    }, [selectedDate]);\r\n\r\n    useEffect(() => {\r\n        fetchTimes();\r\n    }, [fetchTimes]);\r\n\r\n    const fetchBookings = useCallback(async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('bookings')\r\n                .select('*');\r\n\r\n            if (error) throw error;\r\n\r\n            setBookings(data || []);\r\n        } catch (error) {\r\n            console.error('Error fetching bookings:', error);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchBookings();\r\n    }, [fetchBookings]);\r\n\r\n    const handleSaveTimes = async (times) => {\r\n        if (selectedDate) {\r\n            try {\r\n                // Assuming `times` is an array of objects with relevant fields\r\n                for (const time of times) {\r\n                    const { error } = await supabase\r\n                        .from('available-times')\r\n                        .upsert({ date: selectedDate.toDateString(), ...time });\r\n\r\n                    if (error) throw error;\r\n                }\r\n\r\n                setAvailableTimes((prevTimes) => [...prevTimes, ...times]);\r\n            } catch (error) {\r\n                console.error('Failed to save times:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleDeleteTimes = async (timesToDelete) => {\r\n        if (selectedDate) {\r\n            try {\r\n                const { error } = await supabase\r\n                    .from('available-times')\r\n                    .delete()\r\n                    .in('time', timesToDelete)\r\n                    .eq('date', selectedDate.toDateString());\r\n\r\n                if (error) throw error;\r\n\r\n                setAvailableTimes((prevTimes) => prevTimes.filter(time => !timesToDelete.includes(time)));\r\n            } catch (error) {\r\n                console.error('Failed to delete times:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleDeleteBooking = async (bookingId) => {\r\n        if (!bookingId) {\r\n            console.error('No booking ID provided');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const { error } = await supabase\r\n                .from('bookings')\r\n                .delete()\r\n                .eq('id', bookingId);\r\n\r\n            if (error) throw error;\r\n\r\n            setBookings((prevBookings) => prevBookings.filter((booking) => booking.id !== bookingId));\r\n            alert('Booking deleted successfully');\r\n        } catch (error) {\r\n            console.error('Error deleting booking:', error);\r\n            alert('Error deleting booking');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"admin-container\">\r\n            <h1 className=\"heading\">Admin Dashboard</h1>\r\n            <CalendarComponent setSelectedDate={setSelectedDate} />\r\n\r\n            {selectedDate && (\r\n                <div className=\"times-section\">\r\n                    <button\r\n                        className=\"subHeading-dropdown-toggle\"\r\n                        onClick={() => setShowTimesForm(!showTimesForm)}\r\n                    >\r\n                        <h2 className=\"subHeading\">Manage Times for {selectedDate.toDateString()}</h2>\r\n                    </button>\r\n\r\n                    {showTimesForm && (\r\n                        <AvailableTimesForm\r\n                            onSaveTimes={handleSaveTimes}\r\n                            onDeleteTimes={handleDeleteTimes}\r\n                            availableTimes={availableTimes}\r\n                        />\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"section\">\r\n                <h2 className=\"subHeading\">All Bookings</h2>\r\n                <BookingsTable bookings={bookings} onDeleteBooking={handleDeleteBooking} />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst BookingsTable = ({ bookings, onDeleteBooking }) => (\r\n    <div className=\"table-responsive\">\r\n        <table className=\"table\">\r\n            <thead>\r\n                <tr>\r\n                    <th>Date</th>\r\n                    <th>Time</th>\r\n                    <th>Service</th>\r\n                    <th>User Name</th>\r\n                    <th>User Email</th>\r\n                    <th>User Phone</th>\r\n                    <th>Actions</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {bookings.map((booking) => (\r\n                    <tr key={booking.id}>\r\n                        <td>{booking.date}</td>\r\n                        <td>{booking.time}</td>\r\n                        <td>{booking.service}</td>\r\n                        <td>{booking.userName}</td>\r\n                        <td>{booking.userEmail}</td>\r\n                        <td>{booking.userPhone}</td>\r\n                        <td>\r\n                            <button\r\n                                className=\"delete-button\"\r\n                                onClick={() => onDeleteBooking(booking.id)}\r\n                            >\r\n                                Cancel Booking\r\n                            </button>\r\n                        </td>\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n);\r\n\r\nexport default AdminDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}